{"version":3,"file":"openDb.js","mappings":"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","sources":["webpack://songs/./utilis/openDb.cjs"],"sourcesContent":["function TT({name,safeOp}){\n\tthis.db = openDb(name,\"\");\n\tthis.query = this.db.query.bind(this.db);\n\tthis.initialize = ()=>{\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tvar falsed = false;\n\t\t\tthis.query('CREATE TABLE IF NOT EXISTS Categorie(id varchar(50) primary key, name varchar(50) not null unique)',[]).then((s)=>{\n\t\tconsole.log(\"Table Categorie Created with sucess\");\n\t\t\t}).catch((e)=>{\n\t\tconsole.log(\"Table Categorie not Created\",e);\n\t\tfalsed = true;\n\t\t\t});\n\t\t\n\t\t\tthis.query(\"CREATE TABLE IF NOT EXISTS Song(id integer primary key, name varchar(100) not null, verses Text not null, cat varchar(50) not null, unique(name,cat), FOREIGN KEY(cat) REFERENCES Categorie(id))\",[]).then((s)=>{\n\t\tconsole.log(\"Table Song Created with Success\");\n\t\tif(falsed)\n\t\t\treject();\n\t\telse\n\t\t\tresolve();\n\t\t\t}).catch((e)=>{\n\t\tconsole.log(\"Table Song not Created\",e);\n\t\tif(falsed)\n\t\t\treject();\n\t\t\t})\n\t\t})\n\t}\n\tthis.initialize();\n\tthis.clear = ()=>{\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tthis.query('DROP TABLE Categorie',[]).then((s)=>{\n\t\t\t\tif(s){\n\t\t\t\t\tconsole.log(\"Categorie Table Droped\");\n\t\t\t\t\tresolve(true);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tconsole.log(\"Couldn't delete table Categorie\",s);\n\t\t\t\t\tresolve(false);\n\t\t\t\t}\n\t\t\t}).catch((e)=> console.log(\"clear Error\",e));\n\t\t\tthis.query('DROP TABLE Song',[]).then((s)=>{\n\t\t\t\tif(s){\n\t\t\t\t\tconsole.log(\"Song Table Dropped\");\n\t\t\t\t\tresolve(true);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tconsole.log(\"Couldn't delete table Song\");\n\t\t\t\t\tresolve(false);\n\t\t\t\t}\n\t\t\t}).catch((e)=> console.log(\"clear Error\",e))\n\t\t})\n\t}\n\tthis.insertCategorie = (name,id)=>{\n\t\t var txt = 'Wb insertCategorie'\n\t\tvar p = ()=> new Promise((resolve,reject)=>{\n\t\t\tthis.query('INSERT INTO Categorie(name,id) VALUES(?,?)',[safeOp(name,\"toLowerCase\",null),id]).then((s)=>{\n\t\t\t\tif(s.inserted){\n\t\t\t\t\t\n\t\t\t\t\tresolve(s.inserted);\n\n\t\t\t\t\tthis.getCategorie[name] = [{id:s.inserted, name}];\n\t\t\t\t\tthis.getCategorieByKey[s.inserted] = this.getCategorie[name];\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tresolve(false);\n\t\t\t\t}\n\t\t\t}).catch((e)=>{\n\t\t\t\t\t\n\t\t\t\t\treject(e);\n\t\t\t});\n\t\t});\n\t\treturn p;\n\t}\n\tthis.updateCategorie = (name,newName)=>{\n\t\tvar txt = \"Wb updateCategorie \";\n\t\tvar p = ()=>  new Promise((resolve,reject)=>{\n\t\t\tthis.query('UPDATE Categorie SET name=? WHERE name=?',[safeOp(newName,\"toLowerCase\",null),safeOp(name,\"toLowerCase\",null)]).then((s)=>{\n\t\t\t\tif(s.updated){\n\t\t\t\t\t\n\t\t\t\t\tresolve(true);\n\n\t\t\t\t\tif(this.getCategorie[name]){\n\t\t\t\t\t\tthis.getCategorie[newName] = this.getCategorie[name];\n\t\t\t\t\t\tlet id = this.getCategorie[name][0].id;\n\t\t\t\t\t\tthis.getCategorie[newName][0].name = newName;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(this.getCategorieByKey[id])\n\t\t\t\t\t\t\tthis.getCategorieByKey[id][0].name = newName;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\t\n\t\t\t\t\tresolve(false)\n\t\t\t\t}\n\t\t\t}).catch((e)=>{\n\t\t\t\t\n\t\t\t\treject();\n\t\t\t})\n\t\t});\n\n\t\treturn p;\n\t}\n\tthis.removeCategorie = (name)=>{\n\t\tvar txt = \"Wb removeCategorie\"\n\t\tvar p = ()=> new Promise((resolve,reject)=>{\n\n\t\t\tthis.query(\"DELETE FROM Categorie WHERE name=?\",[safeOp(name,\"toLowerCase\",null)]).then((s)=>{\n\n\t\t\t\tif(s.updated){\n\t\t\t\t\tresolve(true);\n\n\t\t\t\t\tif(this.getCategorie[name]){\n\t\t\t\t\t\tlet id = this.getCategorie[name][0].id;\n\t\t\t\t\t\tdelete this.getCategorie[name];\n\t\t\t\t\t\tdelete this.getCategorieByKey[id];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse{\n\n\t\t\t\t\t\n\t\t\t\t\tresolve(false);\n\t\t\t\t}\n\t\t\t}).catch((e)=>{\n\n\t\t\t\t\n\t\t\t\treject(e);\n\t\t\t});\n\t\t});\n\t\treturn p;\n\t}\n\tthis.getCategorie = (name)=>{\n\t\tvar txt = 'Wb getCategorie';\n\t\t\n\t\tvar p = ()=> new Promise((resolve,reject)=>{\n\t\t\t\n\t\t\tif(this.getCategorie[name])\n\t\t\t\treturn resolve(this.getCategorie[name].slice());\n\n\t\t\tthis.query(\"SELECT * from Categorie WHERE name=?\",[safeOp(name,\"toLowerCase\",null)]).then((s)=>{\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tresolve(s.data);\n\t\t\t\t\n\t\t\t\tif(s.data.length){\n\t\t\t\t\tlet id = s.data[0].id;\n\t\t\t\t\t\n\t\t\t\t\tif(!this.getCategorieByKey[id])\n\t\t\t\t\t\tthis.getCategorieByKey[id] = this.getCategorie[name] = s.data;\n\t\t\t\t\telse\n\t\t\t\t\t\tthis.getCategorie[name] = s.data;\n\t\t\t\t}\n\n\t\t\t}).catch((e)=>{\n\t\t\t\t\n\t\t\t\t\n\t\t\t\treject(e);\n\t\t\t})\n\t\t});\n\t\treturn p;\n\t}\n\tthis.getCategorieByKey = (id)=>{\n\t\tvar txt = 'Wb getCategorieByKey'\n\t\tvar p = ()=> new Promise((resolve,reject)=>{\n\t\t\tif(this.getCategorieByKey[id]){\n\t\t\t\treturn resolve(this.getCategorieByKey[id].slice());\n\t\t\t}\n\n\t\t\tthis.query(\"SELECT * FROM Categorie where id=?\",[id]).then((s)=>{\n\t\t\t\t\n\t\t\t\tresolve(s.data);\n\t\t\t\t\n\t\t\t\tif(s.data.length){\n\t\t\t\t\tlet name = s.data[0].name;\n\t\t\t\t\tif(this.getCategorie[name])\n\t\t\t\t\t\tthis.getCategorieByKey[id] = this.getCategorie[name];\n\t\t\t\t\telse{\n\t\t\t\t\t\tthis.getCategorie[name] = this.getCategorieByKey[id] = s.data;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}).catch((e)=>{\n\t\t\t\t\n\t\t\t\treject(e);\n\t\t\t});\n\t\t});\n\n\t\treturn p;\n\t}\n\tthis.getAllCategories = ()=>{\n\t\tvar txt = 'Wb getAllCategories';\n\t\tvar p = ()=> new Promise((resolve,reject)=>{\n\t\t\t\n\t\t\tthis.query(\"SELECT * FROM Categorie\",[]).then((s)=>{\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tresolve(s.data);\n\t\t\t}).catch((e)=>{\n\t\t\t\t\n\t\t\t\t\n\t\t\t\treject(e);\n\t\t\t})\n\t\t});\n\n\t\treturn p; \n\t}\n\tthis.insertSong = (name,verses,cat)=>{\n\t\tvar txt = \"Wb insertSong\";\n\t\tverses = JSON.stringify(verses);\n\n\t\tvar p = ()=> new Promise((resolve,reject)=>{\n\n\t\t\tthis.query(\"INSERT INTO Song(name,verses,cat) VALUES(?,?,?)\",[safeOp(name,\"toUpperCase\",null),verses, cat]).then((s)=>{\n\t\t\t\t\tif(s.inserted){\n\t\t\t\t\t\n\t\t\t\t\t//alert(`${name} inserted`);\n\t\t\t\t\tresolve(true);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\t//alert(`${name} Hug`);\n\t\t\t\t\t\n\t\t\t\t\tresolve(false);\n\t\t\t\t}\n\t\t\t}).catch((e)=>{\n\t\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\treject(e);\n\t\t\t})\n\t\t});\n\n\t\treturn p;\n\t}\n\tthis.updateSong = (name,cat,newName,verses)=>{\n\t\tvar txt = \"Wb updateSong\";\n\t\tname = safeOp(name,\"toUpperCase\",null);\n\t\tnewName = safeOp(newName,\"toUpperCase\",null);\n\t\tvar sql = \"UPDATE Song SET \"+((newName)? \"name=?\"+((verses)? \", verses=?\":\"\"): \"verses=?\")+\" WHERE name=? AND cat=?\"\n\t\tvar holder = [(newName)? newName:verses,(newName && verses)? verses:name,((newName && verses))? name:cat,(newName && verses)? cat: null].filter((s) => s);\n\t\tconsole.log(\"Look at this sql\",sql,holder);\n\t\t//holder = holder.filter((s) => s);\n\t\tvar p = ()=> new Promise((resolve,reject)=>{\n\t\t\tswitch(typeof cat){\n\t\t\t\tcase \"number\":\n\t\t\t\t\tthis.query(sql,holder).then((s)=>{\n\t\t\t\t\t\tif(s.updated){\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tresolve(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tresolve(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t}).catch((e)=>{\n\t\t\t\t\t\t\n\t\t\t\t\t\treject(e);\n\t\t\t\t\t})\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"string\":\n\t\t\t\t\tthis.getCategorie(cat)().then((r)=>{\n\t\t\t\t\t\tif(r){\n\t\t\t\t\t\t\tvar id = r.id;\n\t\t\t\t\t\t\tthis.updateSong(name,id,newName,verses)().then(resolve).catch(reject);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tresolve(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t}).catch(reject);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\t\n\t\t\t\t\treject({type:\"Error\",message:`Wrong categorie type ${cat}`});\n\n\t\t\t}\n\t\t});\n\t\treturn p;\n\t}\n\tthis.deleteSong = (name,cat)=>{\n\t\tvar txt = \"Wb deleteSong\"\n\t\tvar p = ()=> new Promise((resolve,reject)=>{\n\t\t\tswitch(typeof cat){\n\t\t\t\tcase \"number\":\n\t\t\t\t\tthis.query(\"DELETE FROM Song WHERE name=? AND cat=?\",[safeOp(name,\"toUpperCase\",null),cat]).then((s)=>{\n\t\t\t\t\tif(s.updated){\n\t\t\t\t\t\tresolve(true);\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\t\n\t\t\t\t\t\tresolve(false);\n\t\t\t\t\t}\n\t\t\t\t\t}).catch((e)=>{\n\t\t\t\t\t\t\n\t\t\t\t\t\treject(e);\n\t\t\t\t\t})\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"string\":\n\t\t\t\t\tthis.getCategorie(cat)().then((r)=>{\n\t\t\t\t\t\tif(!Array.isArray(r))\n\t\t\t\t\t\t\tthrow Error(\"response should be array\");\n\t\t\t\t\t\tr = r.pop();\n\t\t\t\t\t\tif(r){\n\t\t\t\t\t\t\tvar id = r.id;\n\t\t\t\t\t\t\tthis.deleteSong(name,id)().then(resolve).catch(reject);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t}).catch(reject);\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\t\n\t\t\t\t\treject({type:'error',message:`Bad Categorie type ${cat}`});\n\t\t\t}\n\t\t});\n\t\treturn p;\n\t}\n\tthis.getSong = (name,cat)=>{\n\t\tvar txt = 'Wb getSong';\n\t\tvar p = ()=> new Promise((resolve,reject)=>{\n\t\t\tswitch(typeof cat){\n\t\t\t\tcase \"number\":\n\t\t\t\t\tthis.query(\"SELECT * from Song WHERE name=? AND cat=?\",[safeOp(name,\"toUpperCase\",null),cat]).then((s)=>{\n\t\t\t\t\t\tif(s.data.length){\n\t\t\t\t\t\t\ts.data = s.data.pop();\n\t\t\t\t\t\t\ts.data.verses = JSON.parse(s.data.verses);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\tresolve(s.data);\n\t\t\t\t\t}).catch((e)=>{\n\t\t\t\t\t\t\n\t\t\t\t\t\treject(e);\n\t\t\t\t\t})\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"string\":\n\t\t\t\t\tthis.getCategorie(cat)().then((r)=>{\n\t\t\t\t\t\tr = r.pop();\n\t\t\t\t\t\tif(r){\n\t\t\t\t\t\t\tvar id = r.id;\n\t\t\t\t\t\t\tthis.getSong(name,id)().then(resolve).catch(reject);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tresolve(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t}).catch(reject);\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\t\n\t\t\t\t\treject({type:\"Error\", message:`Wrong type of categorie ${cat}`});\n\t\t\t}\n\n\t\t});\n\t\treturn p;\n\t}\n\tthis.getAllSongs = (cat)=>{\n\t\tvar txt = 'Wb getAllSongs';\n\t\tvar p = ()=> new Promise((resolve,reject)=>{\n\t\t\tthis.query(\"SELECT * FROM Song WHERE cat=?\",[cat]).then((s)=>{\n\t\t\t\t\n\t\t\t\tresolve(s.data);\n\t\t\t}).catch((e)=>{\n\t\t\t\t\n\t\t\t\treject(e);\n\t\t\t})\n\t\t});\n\t\treturn p;\n\t}\n\tthis.countSong = (cat)=>{\n\t\tvar txt = 'Wb countSong';\n\t\tvar p = ()=> new Promise((resolve,reject)=>{\n\t\t\tswitch(typeof cat){\n\t\t\t\tcase \"number\":\n\t\t\t\t\tthis.query(\"SELECT count(*) as TOTAL FROM Song WHERE cat=?\",[cat]).then((s)=>{\n\t\t\t\t\t\t\n\t\t\t\t\t\tresolve(s.data.TOTAL);\n\t\t\t\t\t}).catch((e)=>{\n\t\t\t\t\t\t\n\t\t\t\t\t\treject(e);\n\t\t\t\t\t})\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"string\":\n\t\t\t\t\tthis.getCategorie(cat)().then((r)=>{\n\t\t\t\t\t\tr = r.pop();\n\t\t\t\t\t\tif(r){\n\t\t\t\t\t\t\tvar id = r.id;\n\t\t\t\t\t\t\tthis.countSong(id)().then(resolve).catch(reject);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tresolve(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t}).catch(reject);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\t\n\t\t\t\t\treject({type:'error',message:`Bad Categorie type ${cat}`})\n\t\t\t}\n\t\t});\n\t\treturn p;\n\t}\n\n\tfunction  openDb (name,version=\"1\",size=1024*1024*10){\n\t\tvar D = openDatabase(name,version,name,size);\n\t\tlet rowSealed;\n\t\t\n\t\ttry{\n\t\t\tD.query = (sql,datas=[])=>{\n\t\t\t\treturn new Promise((resolve,reject)=>{\n\t\t\t\t\tD.transaction((t)=>{\n\t\t\t\t\t\tt.executeSql(sql,datas,(tt,s)=> { \n\t\t\t\t\t\t\tvar res = [];\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t//if(s.rows.length){\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tfor(let i=0;;i++){\n\t\t\t\t\t\t\t\t\tlet row;\n\t\t\t\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\trow = s.rows.item(i);\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tcatch(e){\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif(row){\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tif(row.verses){\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tif(rowSealed === false){\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\tres.push(row)\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\telse if(rowSealed){\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\tres.push({...row})\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\tlet oldId = row.id;\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\trow.id = 100;\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\tif(row.id != 100){\n\t\t\t\t\t\t\t\t\t\t\t\t\trowSealed = true;\n\t\t\t\t\t\t\t\t\t\t\t\t\tres.push({...row});\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\trow.id = oldId;\n\t\t\t\t\t\t\t\t\t\t\t\t\trowSealed = false;\n\t\t\t\t\t\t\t\t\t\t\t\t\tres.push(row);\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\telse{\t\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tres.push(row);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//}\n\t\t\t\t\t\t\tvar r = {data:res, updated:s.rowsAffected};\n\t\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\t\tr['inserted'] = s.insertId;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcatch(e){\n\t\t\t\t\t\t\t\tr['inserted'] = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresolve(r);\n\t\t\t\t\t\t}, (tt,e)=> { console.error(\"D.query error\",e); reject(e)});\n\t\t\t\t\t},(e)=> {  reject(e)},(s)=> resolve(null,s));\n\t\t\t\t}) \n\t\t\t}\n\t\t}\n\t\tcatch(e){\n\t\t\tconsole.error(\"openDb Catch error\",e);\n\t\t}\n\n\t\treturn D;\n\t}\n}\nmodule.exports = TT;"],"names":["TT","name","safeOp","db","openDb","query","bind","initialize","Promise","resolve","reject","falsed","then","s","console","log","e","clear","insertCategorie","id","txt","p","inserted","getCategorie","getCategorieByKey","updateCategorie","newName","updated","removeCategorie","slice","data","length","getAllCategories","insertSong","verses","cat","JSON","stringify","updateSong","sql","holder","filter","r","type","message","deleteSong","Array","isArray","Error","pop","getSong","parse","getAllSongs","countSong","TOTAL","version","size","D","openDatabase","rowSealed","datas","transaction","t","executeSql","tt","res","i","row","rows","item","push","oldId","rowsAffected","insertId","error","module","exports"],"sourceRoot":""}